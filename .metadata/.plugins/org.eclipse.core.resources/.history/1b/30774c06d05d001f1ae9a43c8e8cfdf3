package actions;

import java.io.File;
import java.io.IOException;
import java.util.List;

import org.openqa.selenium.By;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebElement;

import com.google.common.io.Files;
import com.utils.neotech.CommonMethods;
import com.utils.neotech.ConfigsReader;

public class Screenshot1 extends CommonMethods {

	public static void main(String[] args) {
		/*
		 * Go to https://hrm.neotechacademy.com/ Log in using our custom methods Go to
		 * PIM menu Add an employee Go to Employee List Get the list of the employees
		 * (Using tables - tr and td) Loop to search for the employee you added When you
		 * find the employee - click on it. Take a screenshot
		 */
		setUp();
		sendText(driver.findElement(By.id("txtUsername")), ConfigsReader.getProperty("username"));
		sendText(driver.findElement(By.id("txtPassword")), ConfigsReader.getProperty("password"));
		driver.findElement(By.xpath("//button[@type='submit']")).click();
		waitForVisibility(driver.findElement(By.xpath("//span[contains(text(),'PIM')]")));
		driver.findElement(By.xpath("//span[contains(text(),'PIM')]")).click();
		waitForVisibility(
				driver.findElement(By.xpath("//a[@id='menu_pim_addEmployee']//span[contains(text(),'Add Employee')]")));
		driver.findElement(By.xpath("//a[@id='menu_pim_addEmployee']//span[contains(text(),'Add Employee')]")).click();
		wait(10);
		waitForVisibility(driver.findElement(By.id("first-name-box")));
		sendText(driver.findElement(By.id("first-name-box")), "John");
		sendText(driver.findElement(By.id("middle-name-box")),"Jimmy");
		sendText(driver.findElement(By.id("last-name-box")), "Marston");
		sendText(driver.findElement(By.id("employeeId")), "52555");
		selectDropdown(driver.findElement(By.id("location")), 27);
		wait(5);
		driver.findElement(By.id("modal-save-button")).click();
		waitForVisibility(driver.findElement(By.id("pimPersonalDetailsForm")));
		driver.findElement(By.xpath("//span[contains(text(),'Employee List')]")).click();
		wait(2);
		List<WebElement> cells = driver.findElements(By.xpath("//table/tbody/tr/td"));

		String employeeName = "John Jimmy Marston";

		for (WebElement cell : cells) {

			String cellText = cell.getText();

			if (cellText.contains(employeeName)) {
				cell.click();
				break;
			}
		}
		TakesScreenshot a = (TakesScreenshot) driver;
		File screenshot = a.getScreenshotAs(OutputType.FILE);
		File screenshotFolder = new File("screenshots/Homework");
		try {
			if (!screenshotFolder.exists()) {
				screenshotFolder.mkdirs();
			}
			File screenshotPath = new File("screenshots/Homework/user-account.png");
			Files.copy(screenshotFolder, screenshotPath);
		} catch (IOException e) {
			e.printStackTrace();
			System.out.println("Unable to save the screenshot!");
		}

	}

}
